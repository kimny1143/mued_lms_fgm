# 技術負債: teacher/mentor命名不整合

## 概要

現在のコードベースでは、同じ実体（講師ユーザー）に対して2つの異なる命名が混在しています：

- `mentor`: ユーザーロールとしての命名、UI表示や一部APIパス
- `teacher`: データベースリレーション、外部キー、内部処理ロジック

この不整合により、Next.jsのダイナミックルーティングにおいて命名衝突が発生し、ビルドエラーの原因となりました。

## 現状の整理

### 「mentor」の使用箇所
- ユーザーの`roleId`の値として（権限・役割の識別子）
- 一部APIエンドポイントの名前（`/api/mentors`など）
- フロントエンド表示用の用語（UIでは「メンター」）

### 「teacher」の使用箇所
- データベースのリレーション名（`TeacherSlots`）
- 外部キー名（`teacherId`）
- 多くのバックエンドロジック（26ファイル以上）

### 問題点
1. 概念的な不整合（同じ実体に複数の名前）
2. コードの理解・保守が難しくなる
3. Next.jsのルーティング制約との衝突

## 暫定的な対応策（2025年Q5実施）

- `/api/lesson-slots/[mentorId]`を`/api/lesson-slots/by-mentor/[id]`に変更
- 内部コードでは引き続き`teacher`を使用
- これにより最小限の変更でビルドエラーを解消

## 恒久的な対応策（将来のリファクタリング）

長期的には命名規則を統一することが望ましい。具体的には：

1. **準備フェーズ**
   - テストカバレッジの向上
   - 依存関係の徹底的な分析
   - 移行計画の策定

2. **段階的実装**
   - データアクセス抽象化レイヤーの導入
   - コードベースを段階的に移行
   - データベースマイグレーションの慎重な実施

3. **命名規則の統一ガイドライン**
   - 「mentor」を推奨用語として標準化
   - 新規コードでは統一された命名規則を適用
   - ドキュメント・コメントの整備

## 懸念事項と注意点

- データベースマイグレーションには特に注意が必要
- 二重書き込み期間を設けるなど安全策を講じる
- 完全な移行には相当な工数が必要と想定される

## 参考情報

- [当初発見されたVercelビルドエラー](https://vercel.com/kimny1143/mued-lms-fgm/deployments/...)
- プロジェクト内で`teacher`関連のコードが使用されているファイル数: 約26ファイル